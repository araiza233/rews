$(document).ready(function(){function h(){$("#jsId").val("");$("#jsNombre").val("");$("#jsPrecio").val("");$("#jsDescripcion").val("");$("#jsCodigo").val("");$("#jsPiezas").val("")}function k(a){var c=0;if(0==a.length)return!1;for(i=0;i<a.length;i++)if(ascii=a.charCodeAt(i),48<=ascii&&57>=ascii||65<=ascii&&90>=ascii||97<=ascii&&122>=ascii||45==ascii)c++;else return!1;return!0}function d(a){return""==a||null==a?!1:!0}function l(){var a=!0;valNombre=$("#jsNombre").val();d(valNombre)?(isNombre=!0,!1== isNombre?($("#msgNombre").html(""),$("#msgNombre").html("<p>Por favor capture unicamente letras y numeros</p>"),$("#jsNombre").css("border","1px solid red"),a=!1):($("#msgNombre").html(""),$("#jsNombre").css("border","1px solid black"))):($("#msgNombre").html(""),$("#msgNombre").html("<p>Por favor capture un nombre</p>"),$("#jsNombre").css("border","1px solid red"),a=!1);valPrecio=$("#jsPrecio").val();if(d(valPrecio)){a:{var c=valPrecio,b=0;for(i=0;i<c.length;i++)if(ascii=c.charCodeAt(i),48<=ascii&& 57>=ascii||46==ascii){if(46==ascii&&(b++,1<b)){isPrecio=!1;break a}}else{isPrecio=!1;break a}isPrecio=isNaN(c)?!1:!0}!1==isPrecio?($("#msgPrecio").html(""),$("#msgPrecio").html("<p>Por favor capture unicamente valores numericos</p>"),$("#jsPrecio").css("border","1px solid red"),a=!1):($("#msgPrecio").html(""),$("#jsPrecio").css("border","1px solid black"))}else $("#msgPrecio").html(""),$("#msgPrecio").html("<p>Por favor capture un precio</p>"),$("#jsPrecio").css("border","1px solid red"),a=!1;valDescripcion= $("#jsDescripcion").val();d(valDescripcion)?(isDescripcion=!0,!1==isDescripcion?($("#msgDescripcion").html(""),$("#msgDescripcion").html("<p>Por favor capture unicamente letras y numeros</p>"),$("#jsDescripcion").css("border","1px solid red"),a=!1):($("#msgDescripcion").html(""),$("#jsDescripcion").css("border","1px solid black"))):($("#msgDescripcion").html(""),$("#msgDescripcion").html("<p>Por favor capture un nombre</p>"),$("#jsDescripcion").css("border","1px solid red"),a=!1);valCodigo=$("#jsCodigo").val(); d(valCodigo)?(isCodigo=k(valCodigo),!1==isCodigo?($("#msgCodigo").html(""),$("#msgCodigo").html("<p>Por favor capture unicamente numeros</p>"),$("#jsCodigo").css("border","1px solid red"),a=!1):($("#msgCodigo").html(""),$("#jsCodigo").css("border","1px solid black"))):($("#msgCodigo").html(""),$("#msgCodigo").html("<p>Por favor capture un codigo</p>"),$("#jsCodigo").css("border","1px solid red"),a=!1);valPiezas=$("#jsPiezas").val();d(valPiezas)?(isPiezas=k(valPiezas),!1==isPiezas?($("#msgPiezas").html(""), $("#msgPiezas").html("<p>Por favor capture unicamente numeros</p>"),$("#msgPiezas").css("border","1px solid red"),a=!1):($("#msgPiezas").html(""),$("#jsPiezas").css("border","1px solid black"))):($("#msgPiezas").html(""),$("#msgPiezas").html("<p>Por favor capture un codigo</p>"),$("#jsPiezas").css("border","1px solid red"),a=!1);return a}function p(a){imagen="images/imagesProducts/"+a+".jpg";a=jQuery.ajax({type:"HEAD",url:imagen,async:!1}).status;$("#rigth").html("");200==a?(res='<tr><td colspan="3"><img src="'+ imagen+'" class="imagensusca" width="100" height="90" title="Ver imagen completa" style="cursor: pointer;"/>',res+="</tr></td>",$("#getImage").html(""),$("#getImage").html("<img src='"+imagen+"' width='675' height='675'/>")):res='<tr><td colspan="3"><img src="images/notAvailable.jpg" width="100" height="90"/></td></tr>';return res}function m(a){""==a?nada++:($("#myform").attr("action","doUpload"),$("#myform").attr("method","post"),$("#myform").attr("enctype","multipart/form-data"),$("#gettingImageInfo").dialog(), $("#gettingImageInfo").dialog("open"),$("#myform").submit())}var e=777;$("#autocompletar2").scannerDetection(function(){e=999;$("#autocompletar2").keyup()});$("#autocompletar2").focus(function(){$(this).css("border","5px solid red")});$("#autocompletar2").focusout(function(){$(this).css("border","1px solid black")});$("#dynamicTable").on("click",".eliminarBoton",function(){$("#jsId").val($(this).closest("tr").find("td:first").text());$("#jsCodigo").val($(this).closest("tr").find("td").eq(1).text()); $("#jsNombre").val($(this).closest("tr").find("td").eq(2).text());$("#jsPrecio").val($(this).closest("tr").find("td").eq(3).text());descripcion=$(this).closest("tr").find("td").eq(4).text();""==descripcion&&(descripcion="-");$("#jsDescripcion").val(descripcion);$("#jsPiezas").val($(this).closest("tr").find("td").eq(6).text());"editar"==$(this).attr("alt")&&(opciones={autoOpen:!1,modal:!0,show:{effect:"blind",duration:1E3},hide:{effect:"explode",duration:1E3},width:700,height:450,minWidth:300,minHeight:300, maxWidth:450,maxHeight:300,buttons:{"Editar registro":q,Cancel:f}},$("#titulo").html("<h3>Editar articulo existente</h3>"));$("#showData").dialog(opciones);$("#showData").dialog({close:function(a,c){$("#autocompletar2").focus()}});$("#showData").dialog("open");$(".campos").css("border","1px solid black");$(".msgCampos").html("");$("#rigth").html(p($("#jsCodigo").val()));$("#rigth").show(5E3)});$("#agregarRecord").click(function(){var a;$("#titulo").html("");a={autoOpen:!1,modal:!0,show:{effect:"blind", duration:1E3},hide:{effect:"explode",duration:1E3},width:700,height:450,minWidth:300,minHeight:300,maxWidth:450,maxHeight:450,buttons:{"Crear registro":n,Cancel:f}};h();$("#titulo").html("<h3>Dar de alta articulo</h3>");$("#showData").dialog(a);$("#showData").dialog({close:function(a,b){$("#autocompletar2").focus()}});$("#showData").dialog("open");$(".campos").css("border","1px solid black");$(".msgCampos").html("");$("#rigth").hide()});var q=function(){if(l()){var a=$("#myform").serialize();$.getJSON("ajax/editarProducto", a,function(a){alert(a.resultado);m($("#upload").val())})}},n=function(){if(l()){var a=$("#myform").serialize();$.getJSON("ajax/guardar",a,function(a){"Ok"==a.resultado?(alert("Registro guardado exitosamente"),m($("#upload").val())):alert("Error: "+a.resultado)})}},f=function(){$("#showData").dialog("close");$("#autocompletar2").focus()},g={autoOpen:!1,modal:!0,show:{effect:"blind",duration:5},hide:{effect:"explode",duration:1E3}};imagesOpciones={autoOpen:!1,modal:!0,show:{effect:"blind",duration:500}, hide:{effect:"fadeOut",duration:2E3},width:700,height:700,minWidth:700,minHeight:700,maxWidth:700,maxHeight:700,position:["center","center"]};$("#gettingInfo").dialog(g);$("#showData").dialog(g);$("#getImage").dialog(imagesOpciones);$("#gettingImageInfo").dialog(g);$("#autocompletar2").keyup(function(){if(999==e)e=777,setTimeout(void 0,5E3);else{var a=$("#myform2").serialize();$.getJSON("ajax/buscarProducto",a,function(a){if("Ok"==a.resultado)if(0<a.productoList.length){$("#dynamicTable").html(""); var b;b="<table class='hovertable' id='tablusca'><tr><th colspan='8'>LISTA DE PRODUCTOS</th>";b+="</tr>";b+="<tr>";b+="<th style='display: none;'>Id</th>";b+="<th>Codigo</th>";b+="<th>Nombre</th>";b+="<th>Precio</th>";b+="<th>Descripcion</th>";b+="<th>Unidad</th>";b+="<th>Piezas</th>";b+="<th>Editar</th>";b+="</tr>";cuantosRegistros=a.productoList.length;100<cuantosRegistros&&(cuantosRegistros=100);for(i=0;i<cuantosRegistros;i++)b+="<tr class='trclass'>",b+="<td style='display: none;'>"+a.productoList[i].idProducto+ "</td>",b+="<td>"+a.productoList[i].codigo+"</td>",b+="<td>"+a.productoList[i].nombre+"</td>",b+="<td>"+a.productoList[i].precio+"</td>",b+="<td>"+$.trim(a.productoList[i].descripcion)+"</td>",b+="<td>"+a.productoList[i].unidadDeVenta+"</td>",b=isNaN(a.productoList[i].piezas)?b+"<td>0</td>":b+("<td>"+a.productoList[i].piezas+"</td>"),b+="<td> <img src='images/editRecord.png' width='20' height='20' class='eliminarBoton' alt='editar' title='Editar: "+a.productoList[i].nombre+"' style='cursor: pointer;'/></td> ", b+="</tr>";b+="</table>";$("#dynamicTable").html(b)}else $("#dynamicTable").html("");else $("#gettingInfo").dialog("open"),$("#gettingInfo").html(""),$("#gettingInfo").append("<p>"+a.resultado+"</p>")})}});$("#rigth").on("click",".imagensusca",function(){$("#getImage").dialog("open")});(function(){mostrar=$("#mostrarGuardar").val();if("si"==mostrar){var a;$("#titulo").html("");a={autoOpen:!1,modal:!0,show:{effect:"blind",duration:1E3},hide:{effect:"explode",duration:1E3},width:700,height:450,minWidth:300, minHeight:300,maxWidth:450,maxHeight:450,buttons:{"Crear registro":n,Cancel:f}};h();$("#titulo").html("<h3>Dar de alta articulo</h3>");$("#showData").dialog(a);$("#showData").dialog({close:function(a,b){$("#autocompletar2").focus()}});$("#showData").dialog("open");$(".campos").css("border","1px solid black");$(".msgCampos").html("");$("#rigth").hide()}else $("#autocompletar2").focus(),$("#autocompletar2").val("")})()});